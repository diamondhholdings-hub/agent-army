---
phase: 10-solution-architect-agent
plan: 03
type: execute
wave: 2
depends_on: ["10-01"]
files_modified:
  - data/knowledge/solution_architect/competitor-analysis-generic.md
  - data/knowledge/solution_architect/architecture-template-rest-api.md
  - data/knowledge/solution_architect/architecture-template-webhook.md
  - data/knowledge/solution_architect/architecture-template-db-sync.md
  - data/knowledge/solution_architect/poc-templates.md
  - scripts/seed_sa_knowledge.py
autonomous: true

must_haves:
  truths:
    - "SA knowledge seed documents exist in data/knowledge/solution_architect/"
    - "Seed script can be invoked and processes all SA knowledge documents"
    - "Competitor analysis data is structured with SWOT analysis and objection responses"
    - "Architecture templates cover REST API, webhook, and database sync patterns"
    - "POC templates cover small, medium, and large tiers with effort estimates"
  artifacts:
    - path: "data/knowledge/solution_architect/competitor-analysis-generic.md"
      provides: "Competitor SWOT analysis and battlecard data"
      contains: "Strengths"
    - path: "data/knowledge/solution_architect/architecture-template-rest-api.md"
      provides: "REST API integration narrative template"
      contains: "integration"
    - path: "data/knowledge/solution_architect/poc-templates.md"
      provides: "POC scoping templates for 3 tiers"
      contains: "Small POC"
    - path: "scripts/seed_sa_knowledge.py"
      provides: "Knowledge ingestion script for SA documents"
      contains: "IngestionPipeline"
  key_links:
    - from: "scripts/seed_sa_knowledge.py"
      to: "src/knowledge/ingestion/pipeline.py"
      via: "IngestionPipeline import and usage"
      pattern: "from src.knowledge.ingestion"
    - from: "data/knowledge/solution_architect/*.md"
      to: "src/knowledge/models.py"
      via: "content_type metadata values"
      pattern: "competitor_analysis|architecture_template|poc_template"
---

<objective>
Create the knowledge seed data for the Solution Architect agent and the script to ingest it into Qdrant. This covers competitor analysis battlecards, architecture narrative templates, and POC scoping templates.

Purpose: The SA agent handlers query Qdrant for domain-specific knowledge via RAG. Without seed data, the RAG queries return empty results and handlers produce low-quality outputs. Even with placeholder content, the full pipeline (data -> ingest -> embed -> store -> retrieve) is validated end-to-end.
Output: 5 markdown knowledge documents in data/knowledge/solution_architect/ and 1 seed script in scripts/.
</objective>

<execution_context>
@/Users/RAZER/.claude/get-shit-done/workflows/execute-plan.md
@/Users/RAZER/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/10-solution-architect-agent/10-RESEARCH.md
@.planning/phases/10-solution-architect-agent/10-01-SUMMARY.md

# Existing knowledge data patterns
@data/products/billing.md
@data/products/positioning/battlecard-vs-competitor-a.md
@src/knowledge/ingestion/pipeline.py
@src/knowledge/ingestion/__init__.py
@src/knowledge/models.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SA knowledge seed documents</name>
  <files>
    data/knowledge/solution_architect/competitor-analysis-generic.md
    data/knowledge/solution_architect/architecture-template-rest-api.md
    data/knowledge/solution_architect/architecture-template-webhook.md
    data/knowledge/solution_architect/architecture-template-db-sync.md
    data/knowledge/solution_architect/poc-templates.md
  </files>
  <action>
    Create the `data/knowledge/solution_architect/` directory.

    **competitor-analysis-generic.md** (content_type: competitor_analysis):
    Create a structured competitor analysis document covering 3 generic competitor archetypes. For each competitor, include:
    - Company overview (2-3 sentences)
    - Strengths (3-4 bullet points)
    - Weaknesses (3-4 bullet points)
    - Key differentiators vs Skyvera (3-4 bullet points)
    - Common objections and pre-built responses (3-4 Q&A pairs)
    - When they win / When we win analysis

    Use fictional but realistic competitor names (e.g., "BillingPro", "ChargeStack", "RevenueOS") that represent different competitive positions (legacy incumbent, modern upstart, enterprise suite). Content should be plausible for an enterprise billing/monetization platform competitive landscape.

    **architecture-template-rest-api.md** (content_type: architecture_template):
    Create a reusable architecture narrative template for REST API integration between Skyvera and a prospect's systems. Include:
    - Integration overview section (template with {{prospect_system}} placeholders)
    - Authentication approach (API keys, OAuth2)
    - Data flow description (inbound and outbound)
    - Endpoints to expose / consume
    - Error handling and retry strategy
    - Rate limiting considerations
    - Security considerations (TLS, IP whitelisting)

    **architecture-template-webhook.md** (content_type: architecture_template):
    Same structure as REST API but for webhook-based event integration. Cover:
    - Event types Skyvera publishes
    - Webhook delivery guarantees (at-least-once)
    - Signature verification
    - Retry and dead letter handling
    - Webhook registration API

    **architecture-template-db-sync.md** (content_type: architecture_template):
    Same structure but for database sync integration. Cover:
    - CDC (Change Data Capture) approach
    - Sync frequency and latency expectations
    - Conflict resolution strategy
    - Schema mapping considerations
    - Data transformation pipeline

    **poc-templates.md** (content_type: poc_template):
    Create 3 tiered POC templates:

    **Small POC (5-10 dev days):**
    - Scope: Single integration point (e.g., REST API for invoice sync)
    - Deliverables: Working API endpoint, sample data migration, basic dashboard
    - Success criteria: 2 measurable outcomes
    - Resource estimate: 5-10 dev days, 2 QA days, 8 PM hours
    - Timeline: 2-3 weeks

    **Medium POC (15-25 dev days):**
    - Scope: Multi-integration (e.g., billing sync + webhook events + reporting)
    - Deliverables: 4 deliverables with acceptance criteria
    - Success criteria: 3 measurable outcomes
    - Resource estimate: 15-25 dev days, 5 QA days, 16 PM hours
    - Timeline: 4-6 weeks

    **Large POC (30-60 dev days):**
    - Scope: Full platform integration (billing + charging + monetization)
    - Deliverables: 8 deliverables with acceptance criteria
    - Success criteria: 5 measurable outcomes
    - Resource estimate: 30-60 dev days, 10 QA days, 40 PM hours
    - Timeline: 8-12 weeks

    Each document should be well-structured with markdown headers so the ingestion chunker produces meaningful chunks. Use the style of existing data/products/ documents as reference.
  </action>
  <verify>
    Run: `ls -la data/knowledge/solution_architect/` should show 5 files
    Run: `wc -l data/knowledge/solution_architect/*.md` should show each file is at least 40 lines (enough for meaningful chunks)
  </verify>
  <done>
    5 markdown documents exist in data/knowledge/solution_architect/. Each document is substantial enough (40+ lines) to produce multiple knowledge chunks. Content covers all 3 SA knowledge categories: competitor analysis, architecture templates, and POC templates.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create SA knowledge seed script</name>
  <files>scripts/seed_sa_knowledge.py</files>
  <action>
    Create `scripts/seed_sa_knowledge.py` that ingests the SA knowledge documents into Qdrant. Follow the existing codebase ingestion patterns.

    The script should:

    1. **Parse arguments:** Accept `--tenant-id` (default: "skyvera") and `--data-dir` (default: "data/knowledge/solution_architect")

    2. **Map files to content_types:**
    ```python
    FILE_CONTENT_TYPE_MAP = {
        "competitor-analysis": "competitor_analysis",
        "architecture-template": "architecture_template",
        "poc-templates": "poc_template",
    }
    ```
    Match file names against these prefixes to assign content_type.

    3. **Initialize pipeline components:**
    - Import and create: `QdrantKnowledgeStore`, `EmbeddingService`, `KnowledgeChunker`, `MetadataExtractor`, `IngestionPipeline`
    - Use the same initialization pattern as existing scripts (check scripts/provision_tenant.py for reference)
    - Wrap in try/except for graceful failure if Qdrant/embedding services are not available

    4. **Process each file:**
    - Load document via `DocumentLoader`
    - Chunk via `KnowledgeChunker`
    - For each chunk, set `metadata.content_type` to the mapped value from step 2
    - Set `metadata.product_category` to "monetization" (default -- SA content spans all products)
    - Embed and upsert via pipeline

    5. **Report results:**
    - Print summary: files processed, chunks created, errors encountered
    - Exit with code 0 on success, 1 on errors

    IMPORTANT: The script must work even if Qdrant is not running -- it should catch connection errors and print a helpful message ("Qdrant not available. Start it with: docker run -p 6333:6333 qdrant/qdrant") rather than crashing with a stack trace.

    IMPORTANT: The script should be runnable standalone: `python scripts/seed_sa_knowledge.py` from the project root. Add `if __name__ == "__main__":` guard. Add sys.path manipulation if needed to find project modules (check existing scripts for the pattern).

    Add a module docstring explaining what the script does and how to run it.
  </action>
  <verify>
    Run: `python -c "import scripts.seed_sa_knowledge"` -- no import errors (or at least no syntax errors)
    Run: `python scripts/seed_sa_knowledge.py --help 2>/dev/null || python scripts/seed_sa_knowledge.py --tenant-id test 2>&1 | head -5` -- script starts and either processes files or reports Qdrant unavailable (both are acceptable)
  </verify>
  <done>
    `scripts/seed_sa_knowledge.py` exists and is executable. It maps SA knowledge documents to correct content_types. It reports results on success or gives a helpful error when Qdrant is not available. The file-to-content_type mapping is correct for all 5 documents.
  </done>
</task>

</tasks>

<verification>
1. `ls data/knowledge/solution_architect/*.md | wc -l` returns 5
2. `python scripts/seed_sa_knowledge.py --tenant-id test 2>&1` either succeeds or fails gracefully
3. Each markdown file has meaningful, chunker-friendly content (headers, paragraphs)
4. Existing tests still pass: `python -m pytest tests/ -x -q --timeout=30`
</verification>

<success_criteria>
- 5 knowledge documents exist with substantive content for each SA knowledge category
- Seed script is runnable and maps documents to correct content_types
- Script handles Qdrant unavailability gracefully (no crash, helpful message)
- Documents follow the markdown structure convention of existing data/products/ files
</success_criteria>

<output>
After completion, create `.planning/phases/10-solution-architect-agent/10-03-SUMMARY.md`
</output>
